{"mappings":"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","sources":["public/js/alert.js","public/js/login.js","public/js/updateSetting.js","public/js/stripe.js","public/js/index.js"],"sourcesContent":["/* eslint-disable */\n\n\nexport const hideAlert = () =>{\n    const el = document.querySelector('.alert');\n    if(el) el.parentElement.removeChild(el);\n}\n\n\n// type =success or error\nexport const showAlert = (type, msg)=>{\n\n    hideAlert();    \n    const markup = `<div class=\"alert alert--${type}\">${msg}</div>`;\n    document.querySelector('body').insertAdjacentHTML('afterbegin', markup);\n    window.setTimeout(hideAlert,5000);\n}\n\n","/* eslint-disable */\n\nimport axios from \"axios\"; // npm i axios\nimport { showAlert } from \"./alert\";\n\nexport const login = async(email, password) =>{\n    try {\n        const res = await axios({\n            method:'POST',\n            // url: 'http://localhost:3000/api/v1/users/login',\n            url: '/api/v1/users/login',\n            data:{\n                email,\n                password\n            }\n        });\n\n        if (res.data.status === 'Success'){\n            showAlert('success','Logged in successfully!');\n            window.setTimeout(()=>{\n                location.assign('/');\n            }, 1500);\n        }\n        \n    } catch (error) {\n        showAlert('error',error.response.data.message);\n    }\n}\n\nexport const logout = async ()=>{\n\n    try {\n        const res = await axios({\n            method:'GET',\n            // url:'http://localhost:3000/api/v1/users/logout',\n            url:'/api/v1/users/logout',\n\n        });\n\n        if(res.data.status = 'Success') location.reload(true);\n\n    } catch (error) {\n        showAlert('error', 'Error logging out! Try again')\n    }\n}\n\n","/* eslint-disable */\n\nimport axios from 'axios';\nimport {showAlert} from './alert';\n\n\n//type is either 'password' or data\nexport const updateSettings = async (data, type) =>{\n    try{\n        const url = type === 'password'\n        ? '/api/v1/users/updateMyPassword' \n        : '/api/v1/users/updateMe';\n            // ? 'http://localhost:3000/api/v1/users/updateMyPassword' \n            // : 'http://localhost:3000/api/v1/users/updateMe';\n\n        const res= await axios({\n            method:'PATCH',\n            url,\n            data\n        });\n        if(res.data.status === 'success'){\n            showAlert('success', `${type.toUpperCase()} updated successfully!`);\n        }\n\n    }catch (err){\n        showAlert('error', err.response.data.message)\n    }\n}\n","/* eslint-disable */\nimport axios  from 'axios';\nimport { showAlert } from \"./alert\";\n\nconst stripe = Stripe('pk_test_51Mwfk9DufsejNW6Ff9aW1joaHWaMDua11sUh98f5JFyRd5djz1TisLHViJHrR6lBQwKA86ir2aHM0j4FB6WEb0qJ00PWaMJADV');\n\nexport const bookTour = async tourId =>{\n//1 get the checkout session from API server\ntry{\n    // const session = await axios(`http://127.0.0.1:3000/api/v1/bookings/checkout-session/${tourId}`);\n    const session = await axios(`/api/v1/bookings/checkout-session/${tourId}`);\n    await stripe.redirectToCheckout({\n        sessionId: session.data.session.id\n    });\n}catch(Er){\n    //console.log(err);\n    showAlert('error', err);\n}\n//2 Create checkout form + charge creadit card\n\n\n}","/* eslint-disable */\nimport '@babel/polyfill';\nimport 'polyfill';\nimport { login, logout } from './login';\nimport {updateSettings} from './updateSetting';\nimport {bookTour} from './stripe';\n\n// install a polyfill which will make some of the newer Javascript features work in older browsers as well\n// npm i @babel/polyfill or npm i polyfill for latest npm\n\n//DOM ELEMENTS\nconst loginForm = document.querySelector('.form--login');\nconst logOutBtn = document.querySelector('.nav__el--logout');\nconst userDataForm = document.querySelector('.form-user-data');\nconst userPasswordForm = document.querySelector('.form-user-password');\nconst bookBtn = document.getElementById('book-tour');\n\n\n\n// Values\n\n\n//DELEGATION\n\nif(loginForm){\n    loginForm.addEventListener('submit',e =>{\n        e.preventDefault();\n            const email = document.getElementById('email').value;\n            const password = document.getElementById('password').value;\n        login(email, password); \n    });\n}\n\nif(logOutBtn) {\n  \n    logOutBtn.addEventListener('click', logout);\n}\n\nif(userDataForm){\n    userDataForm.addEventListener('submit', e=>{\n        e.preventDefault();\n\n        const form  = new FormData();\n        form.append('name',document.getElementById('name').value);\n        form.append('email',document.getElementById('email').value);\n        form.append('photo', document.getElementById('photo').files[0]);\n\n        updateSettings(form,'data');\n\n        // const name = document.getElementById('name').value;\n        // const email = document.getElementById('email').value;\n        // updateSettings({name, email},'data');\n    });\n}\n\nif(userPasswordForm){\n    userPasswordForm.addEventListener('submit',async e=>{\n        e.preventDefault();\n\n        document.querySelector('.btn--save-password').textContent = \"Updating...\";\n\n        const passwordCurrent = document.getElementById('password-current').value;\n        const password = document.getElementById('password').value;\n        const passwordConfirm = document.getElementById('password-confirm').value;\n\n        const result  = await updateSettings({passwordCurrent, password, passwordConfirm},'password');\n        \n        document.querySelector('.btn--save-password').textContent = \"Save Password\";\n        document.getElementById('password-current').value = \"\";\n        document.getElementById('password').value = \"\";\n        document.getElementById('password-confirm').value = \"\";\n\n    })\n}\n\nif (bookBtn){\n    alert(\"clicked\");\n    bookBtn.addEventListener('click', e=>{\n        e.target.textContent = 'Processing...';\n        // const tourId = e.target.dataset.tourId; OR\n        const {tourId} = e.target.dataset;\n        \n        bookTour(tourId);\n    });\n}\n    \n"],"names":["$e9c91518574fdb31$export$516836c6a9dfc573","el","document","querySelector","parentElement","removeChild","$e9c91518574fdb31$export$de026b00723010c1","type","msg","markup","insertAdjacentHTML","window","setTimeout","$bf5b431e6a69fea8$export$596d806903d1f59e","async","email","password","$parcel$interopDefault","$cnf0l$axios","method","url","data","status","location","assign","error","response","message","$f10a946384e2fe45$export$f558026a994b6051","toUpperCase","err","$9fd71c92b6f885af$var$stripe","Stripe","$9fd71c92b6f885af$export$8d5bdbf26681c0c2","tourId","session","redirectToCheckout","sessionId","id","Er","$407eccdc61ba7a94$var$loginForm","$407eccdc61ba7a94$var$logOutBtn","$407eccdc61ba7a94$var$userDataForm","$407eccdc61ba7a94$var$userPasswordForm","$407eccdc61ba7a94$var$bookBtn","getElementById","addEventListener","e","preventDefault","value","reload","form","FormData","append","files","textContent","passwordCurrent","passwordConfirm","alert","target","dataset"],"version":3,"file":"index.js.map","sourceRoot":"../../../"}